<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>JavaInspect - Utility to visualize java software</title>
<!-- 2015-03-03 Tue 22:38 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="generator" content="Org-mode" />
<meta  name="author" content="Svjatoslav Agejenko" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center; }
  .todo   { font-family: monospace; color: red; }
  .done   { color: green; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.right  { text-align: center;  }
  th.left   { text-align: center;   }
  th.center { text-align: center; }
  td.right  { text-align: right;  }
  td.left   { text-align: left;   }
  td.center { text-align: center; }
  dt { font-weight: bold; }
  .footpara:nth-child(2) { display: inline; }
  .footpara { display: block; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="http://thomasf.github.io/solarized-css/solarized-dark.min.css" />
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">JavaInspect - Utility to visualize java software</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1. General</a></li>
<li><a href="#sec-2">2. Example graphs</a></li>
<li><a href="#sec-3">3. Usage</a>
<ul>
<li><a href="#sec-3-1">3.1. example 1: individually picked objects</a></li>
<li><a href="#sec-3-2">3.2. example 2: scan java code, apply filters</a></li>
</ul>
</li>
<li><a href="#sec-4">4. Embedding JavaInspect in your Maven project</a></li>
<li><a href="#sec-5">5. Requirements</a></li>
<li><a href="#sec-6">6. <span class="todo TODO">TODO</span> </a></li>
</ul>
</div>
</div>
<hr  />
<ul class="org-ul">
<li><a href="http://www2.svjatoslav.eu/gitweb/?p=javainspect.git;a=snapshot;h=HEAD;sf=tgz">download latest snapshot</a>
</li>

<li>This program is free software; you can redistribute it and/or modify
it under the terms of version 3 of the <a href="https://www.gnu.org/licenses/lgpl.html">GNU Lesser General Public
License</a> or later as published by the Free Software Foundation.
</li>

<li>Program author:
<ul class="org-ul">
<li>Svjatoslav Agejenko
</li>
<li>Homepage: <a href="http://svjatoslav.eu">http://svjatoslav.eu</a>
</li>
<li>Email: <a href="mailto://svjatoslav@svjatoslav.eu">mailto://svjatoslav@svjatoslav.eu</a>
</li>
</ul>
</li>

<li><a href="http://svjatoslav.eu/programs.jsp">other applications hosted at svjatoslav.eu</a>
</li>
</ul>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> General</h2>
<div class="outline-text-2" id="text-1">
<p>
Goal: simplify/speed up understanding the computer program code by
automatically visualizing its structure.
</p>

<p>
JavaInspect is a Java library that primarily uses Java reflection to
discover and visualize any part of Java program provided that
classes to be visualised are available in the classpath.
</p>

<p>
JavaInspect currently has no GUI, configuration files, embedded
scripting support, direct Maven or Ant integration. The only way to
instuct Javainspect what to do is by using its Java API.
</p>

<p>
To get JavaInspect into same classpath with your projecs I so far came
up with 2 solutions:
</p>

<ol class="org-ol">
<li>Add JavaInspect library in your project as a dependency.
</li>
<li>Create new Java project for the purpose visualizing your other
projects and include JavaInspect and your projecs binary artifacts
(Jar's) into new project classpath. Built binary Jar's (with no
source code) are sufficient because JavaInspect operates via
reflection.
</li>
</ol>

<p>
After discovering application structure and optionally filtering out
unimportant parts, JavaInspect produces GraphViz dot file that
describes data to be visualized. Then launches GraphViz to generate
bitmap graph in PNG format. By default on your Desktop directory.
</p>

<p>
Note: GraphViz is developed and tested so far only on GNU Linux.
</p>
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> Example graphs</h2>
<div class="outline-text-2" id="text-2">
<ul class="org-ul">
<li>A very simple example:


<div class="figure">
<p><a href="example.png"><img src="example.resized.png" alt="example.resized.png" /></a>
</p>
</div>

<p>
Graph legend:
</p>


<div class="figure">
<p><img src="legend.png" alt="legend.png" />
</p>
</div>
</li>

<li>Example visualization of <a href="http://www2.svjatoslav.eu/gitbrowse/sixth/doc/">Sixth</a> project: <a href="http://www2.svjatoslav.eu/projects/sixth/codegraphs/">architecture graphs</a>.
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3"><span class="section-number-2">3</span> Usage</h2>
<div class="outline-text-2" id="text-3">
<p>
Currently the only way to control JavaInspect is by using Java
API. Simple Java based control/configuration code needs to be written
for each project. I usually put such code into directories devoted for
JUnit tests. Because it needs not to be compiled/embedded into final
product or project artifact I'm just willing to visualize.
</p>

<p>
Control code in general does the following:
</p>
<ol class="org-ol">
<li>Create graph object.
</li>
<li>Java reflection/classloaders does not provide mechanism for
discovering all classes under given package. Therefore you need to
declare at least some classes to be added to the graph by:
<ul class="org-ul">
<li>Manually adding individual classes to the graph.
</li>
<li>and/or: Let GraphViz recursively scan and parse specified
directories with Java source code files to discover class names.
</li>
<li>For every class added to the graph, GraphViz will recursively
inspect it and add all referecned classes to the graph as well.
</li>
</ul>
</li>
<li>Graphs easilly get very big and complex so optionally we filter
important code using classname wildcards patterns based blacklist
and/or whitelist.
</li>
<li>Optionally we can tune some rendering parameters like:
<ul class="org-ul">
<li>Possibility to remove orphaned classes (classes with no
references) from the graph.
</li>
<li>Specify target directory for generated visualization
files. (Default is user desktop directory)
</li>
<li>Keep intermediate GraphViz dot file for later inspection.
</li>
</ul>
</li>
<li>Render graph.
</li>
</ol>
</div>


<div id="outline-container-sec-3-1" class="outline-3">
<h3 id="sec-3-1"><span class="section-number-3">3.1</span> example 1: individually picked objects</h3>
<div class="outline-text-3" id="text-3-1">
<p>
This example demonstrates generating of class graph from hand picked
classes and visualizing GraphViz itself.
</p>

<div class="org-src-container">

<pre class="src src-java"><span style="color: #8C8C8C;">// </span><span style="color: #8C8C8C;">Create graph</span>
<span style="color: #F92672;">final</span> <span style="color: #66D9EF;">ClassGraph</span> <span style="color: #FD971F;">graph</span> = <span style="color: #F92672;">new</span> <span style="color: #66D9EF;">ClassGraph</span>();

<span style="color: #8C8C8C;">// </span><span style="color: #8C8C8C;">Add some random object to the graph. GraphViz will detect Class from</span>
<span style="color: #8C8C8C;">// </span><span style="color: #8C8C8C;">the object.</span>
graph.add(graph);

<span style="color: #8C8C8C;">// </span><span style="color: #8C8C8C;">Also add some random class to the graph.</span>
graph.add(Utils.<span style="color: #F92672;">class</span>);

<span style="color: #8C8C8C;">// </span><span style="color: #8C8C8C;">Keep intermediary GraphViz DOT file for reference.</span>
graph.setKeepDotFile(<span style="color: #FF80F4;">true</span>);

<span style="color: #8C8C8C;">// </span><span style="color: #8C8C8C;">Produce bitmap image titled "JavaInspect.png" to the user Desktop</span>
<span style="color: #8C8C8C;">// </span><span style="color: #8C8C8C;">directory</span>
graph.generateGraph(<span style="color: #EEDC82;">"JavaInspect"</span>);
</pre>
</div>

<p>
Note: if desired, more compact version of the above:
</p>
<div class="org-src-container">

<pre class="src src-java"><span style="color: #F92672;">new</span> <span style="color: #66D9EF;">ClassGraph</span>().add(randomObject, RandomClass.<span style="color: #F92672;">class</span>)
                .setKeepDotFile(<span style="color: #FF80F4;">true</span>).generateGraph(<span style="color: #EEDC82;">"JavaInspect"</span>);
</pre>
</div>


<p>
Result:
</p>
<ul class="org-ul">
<li>Generated DOT file: <a href="JavaInspect.dot">JavaInspect.dot</a>
</li>
<li>Generated PNG image: <a href="JavaInspect.png">JavaInspect.png</a>
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-3-2" class="outline-3">
<h3 id="sec-3-2"><span class="section-number-3">3.2</span> example 2: scan java code, apply filters</h3>
<div class="outline-text-3" id="text-3-2">
<div class="org-src-container">

<pre class="src src-java"><span style="color: #8C8C8C;">// </span><span style="color: #8C8C8C;">Create graph</span>
<span style="color: #F92672;">final</span> <span style="color: #66D9EF;">ClassGraph</span> <span style="color: #FD971F;">graph</span> = <span style="color: #F92672;">new</span> <span style="color: #66D9EF;">ClassGraph</span>();

<span style="color: #8C8C8C;">// </span><span style="color: #8C8C8C;">Recursively scan current directory for Java source code and attempt</span>
<span style="color: #8C8C8C;">// </span><span style="color: #8C8C8C;">to detect class names from there to be added to the graph.</span>
graph.addProject(<span style="color: #EEDC82;">"."</span>);

<span style="color: #8C8C8C;">// </span><span style="color: #8C8C8C;">Blacklist example classes from being shown on the graph</span>
graph.blacklistClassPattern(<span style="color: #EEDC82;">"eu.svjatoslav.inspector.java.structure.example.*"</span>);

<span style="color: #8C8C8C;">// </span><span style="color: #8C8C8C;">do not show single classes with no relationships on the graph</span>
graph.hideOrphanedClasses();

<span style="color: #8C8C8C;">// </span><span style="color: #8C8C8C;">Produce bitmap image titled "JavaInspect full project.png" to the</span>
<span style="color: #8C8C8C;">// </span><span style="color: #8C8C8C;">user Desktop directory.</span>
graph.generateGraph(<span style="color: #EEDC82;">"JavaInspect full project"</span>);
</pre>
</div>
<p>
Result:
</p>
<ul class="org-ul">
<li>Generated PNG image: <a href="JavaInspect%20full%20project.png">JavaInspect full project.png</a>
</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4"><span class="section-number-2">4</span> Embedding JavaInspect in your Maven project</h2>
<div class="outline-text-2" id="text-4">
<p>
Declare JavaInspect as dependency:
</p>
<div class="org-src-container">

<pre class="src src-xml">&lt;<span style="color: #A6E22E;">dependencies</span>&gt;
    ...
    &lt;<span style="color: #A6E22E;">dependency</span>&gt;
        &lt;<span style="color: #A6E22E;">groupId</span>&gt;eu.svjatoslav&lt;/<span style="color: #A6E22E;">groupId</span>&gt;
        &lt;<span style="color: #A6E22E;">artifactId</span>&gt;javainspect&lt;/<span style="color: #A6E22E;">artifactId</span>&gt;
        &lt;<span style="color: #A6E22E;">version</span>&gt;1.5-SNAPSHOT&lt;/<span style="color: #A6E22E;">version</span>&gt;
    &lt;/<span style="color: #A6E22E;">dependency</span>&gt;
    ...
&lt;/<span style="color: #A6E22E;">dependencies</span>&gt;
</pre>
</div>


<p>
Add Maven repository to retrieve artifact from:
</p>
<div class="org-src-container">

<pre class="src src-xml">&lt;<span style="color: #A6E22E;">repositories</span>&gt;
    ...
    &lt;<span style="color: #A6E22E;">repository</span>&gt;
        &lt;<span style="color: #A6E22E;">id</span>&gt;svjatoslav.eu&lt;/<span style="color: #A6E22E;">id</span>&gt;
        &lt;<span style="color: #A6E22E;">name</span>&gt;Svjatoslav repository&lt;/<span style="color: #A6E22E;">name</span>&gt;
        &lt;<span style="color: #A6E22E;">url</span>&gt;http://www2.svjatoslav.eu/maven/&lt;/<span style="color: #A6E22E;">url</span>&gt;
    &lt;/<span style="color: #A6E22E;">repository</span>&gt;
    ...
&lt;/<span style="color: #A6E22E;">repositories</span>&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-5" class="outline-2">
<h2 id="sec-5"><span class="section-number-2">5</span> Requirements</h2>
<div class="outline-text-2" id="text-5">
<p>
<a href="http://www.graphviz.org/">GraphViz</a> - shall be installed on the computer.
</p>

<p>
On Ubuntu/Debian use:
</p>
<div class="org-src-container">

<pre class="src src-sh">sudo apt-get install graphviz
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-6" class="outline-2">
<h2 id="sec-6"><span class="section-number-2">6</span> <span class="todo TODO">TODO</span> </h2>
<div class="outline-text-2" id="text-6">
<ul class="org-ul">
<li>BUG: Should not hide references if there are too many of them to
classes if referring classes are not visible anyway because of
blacklist/whitelist rules. Basically reference counting should
exclude not visible classes.
</li>
<li>FEATURE: add dark theme
</li>
<li>FEATURE: sort Class fields by alphabet
</li>
<li>FEATURE: visualize also concrete field values so it could be used as
ultra cool runtime logging framework
</li>
<li>FEATURE: possibility to visualize structure and data from JVM
snapshot
</li>
<li>FEATURE: possibility to attach to remote process to visualize
data/structure using JVM debug port and mechanism.
</li>
<li>FEATURE: possibility to attach to JVM using JVM agent
</li>
<li>FEATURE: possibility to script javainspect behavior
</li>
<li>FEATURE: possibility to select classes/fields/values to be
visualized in SQL like syntax
</li>
<li>FEATURE: configurable maven plugin to generate graphs as part of the
project build/release process
</li>
</ul>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Svjatoslav Agejenko</p>
<p class="date">Created: 2015-03-03 Tue 22:38</p>
<p class="creator"><a href="http://www.gnu.org/software/emacs/">Emacs</a> 24.4.1 (<a href="http://orgmode.org">Org</a> mode 8.2.10)</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
